{"slots":{"0":{"name":"Container","type":{"events":[],"methods":[]}},"1":{"name":"slot2","type":{"events":[],"methods":[]}},"2":{"name":"slot3","type":{"events":[],"methods":[]}},"3":{"name":"slot4","type":{"events":[],"methods":[]}},"4":{"name":"slot5","type":{"events":[],"methods":[]}},"5":{"name":"slot6","type":{"events":[],"methods":[]}},"6":{"name":"slot7","type":{"events":[],"methods":[]}},"7":{"name":"slot8","type":{"events":[],"methods":[]}},"8":{"name":"slot9","type":{"events":[],"methods":[]}},"9":{"name":"slot10","type":{"events":[],"methods":[]}},"-1":{"name":"unit","type":{"events":[],"methods":[]}},"-3":{"name":"player","type":{"events":[],"methods":[]}},"-2":{"name":"construct","type":{"events":[],"methods":[]}},"-4":{"name":"system","type":{"events":[],"methods":[]}},"-5":{"name":"library","type":{"events":[],"methods":[]}}},"handlers":[{"code":"containerContentUpdate()","filter":{"args":[],"signature":"onContentUpdate()","slotKey":"0"},"key":"4"},{"code":"update()","filter":{"args":[{"value":"update"}],"signature":"onTimer(timerid)","slotKey":"-1"},"key":"1"},{"code":"if databank ~= nil then\r\n    databank.setStringValue(\"options\", json.encode(options))\r\nend","filter":{"args":[],"signature":"onStop()","slotKey":"-1"},"key":"2"},{"code":"--[[ LUA PARAMETERS ]]\nuseDatabankValues = true --export: If checked and if values were saved in databank, parmaters will be loaded from the databank, if not, following ones will be used\ncheckSchematicsContainer = true --export: Should we indicate if linked container is set to be used as schematics container\nlocal Localize = false --export: When enabled we will localize schematic names\n\nscreens = {}\ndatabank = nil\ncontainer = nil\nrequestingUpdateContent = false\n\noptions = {}\noptions.checkSchematicsContainer = checkSchematicsContainer\noptions.Localize = Localize\n\nmfloor = math.floor\nmround = math.round\nmabs = math.abs\n\nlinkedToSchemContainer = false\n\nfunction round(number, decimals)\n    local power = 10 ^ decimals\n    return mfloor(mfloor(number * power)) / power\nend\n\nfunction getDirection(element)\n    local position = \"vl\"\n    if mabs(element.getUp()[1]) > mabs(element.getUp()[2]) and mabs(element.getUp()[1]) > mabs(element.getUp()[3]) then\n        if element.getForward()[3] < 0 then\n            position = \"fd\"\n        else\n            position = \"fu\"\n        end\n    else\n        if mabs(element.getUp()[2]) > mabs(element.getUp()[3]) then\n            if element.getUp()[2] > 0 then\n                position = \"vr\"\n            else\n                position = \"vl\"\n            end\n        else\n            if element.getUp()[3] > 0 then\n                position = \"hu\"\n            else\n                position = \"hd\"\n            end\n        end\n    end\n    return position\nend\n\nfor key, value in pairs(unit) do\n    if type(value) == \"table\" and type(value.export) == \"table\" then\n        if value.getClass then\n            if value.getClass() == \"ScreenUnit\" then\n                local screenNumber = 1\n                if string.match(value.getName():lower(), \"screen_\") ~= nil then\n                    screenNumber = tonumber(string.sub(value.getName():lower(), 8, 8))\n                end\n\n                screens[#screens + 1] = { screen = value, slot = key, sn = screenNumber, dir = getDirection(value)}\n                value.activate()\n            elseif value.getClass() == \"CoreUnitStatic\" or value.getClass() == \"CoreUnitSpace\" or value.getClass() == \"CoreUnitDynamic\" then\n                core = value\n            elseif value.getClass():lower() == \"databankunit\" then\n                databank = value\n            elseif string.match(value.getClass():lower(), \"container\") then\n                container = value\n\n                if construct.getSchematicContainerId() == value.getLocalId() then\n                    linkedToSchemContainer = true\n                end\n            end\n        end\n    end\nend\n\nif #screens == 0 then\n    system.print(\"No screen detected\")\nelse\n    local plural = \"\"\n    if #screens > 1 then plural = \"s\" end\n    system.print(#screens .. \" screen\" .. plural .. \" connected\")\nend\n\nif not container then\n    system.print(\"Container NOT found\")\nend\n\nif core == 0 then\n    system.print(\"No core detected\") else system.print(\"Core connected\")\nend\n\nif not databank then\n    system.print(\"No Databank Detected\")\nelse\n    system.print(\"Databank Connected\")\n    if (databank.hasKey(\"options\")) and (useDatabankValues == true) then\n        local db_options = json.decode(databank.getStringValue(\"options\"))\n        if db_options then\n            for key, value in pairs(options) do\n                if db_options[key] then options[key] = db_options[key] end\n            end\n            system.print(\"Options Loaded From Databank\")\n        else\n            system.print(\"No parameters saved to Databank. Restart the Programming Board\")\n        end\n    else\n        system.print(\"Options Loaded From LUA Parameters\")\n    end\nend\n\nschematics = {}\n\ntempTier = 0\nsubTempTier = 0\nScreenNumber = 1\n\nfunction setTier(tier)\n    tempTier = tier\nend\n\nfunction setSubTempTier(tier)\n    subTempTier = tier\nend\n\nfunction moveToNextScreen()\n    ScreenNumber = ScreenNumber + 1\nend\n\nfunction addSchematic(id, max, priority)\n    local item = system.getItem(id)\n\n    local name = Localize and item.locDisplayName or item.displayName\n\n    -- English cleanup\n    name = name:gsub(\"Schematic Copy\", \"\")\n    name = name:gsub(\"Tier \" .. tempTier, \"\")\n    name = name:gsub(\"Tier \" .. subTempTier, \"\")\n    name = name:gsub(\"Construct Support\", \"\")\n    name = name:gsub(\"Core Unit\", \"\")\n    name = name:gsub(\"Scrap\", \"\")\n\n    --German cleanup\n    name = name:gsub(\"Stufe\", \"\")\n    name = name:gsub(\"-\", \" \")\n    name = name:gsub(\"Schema\", \"\")\n    \n    -- French cleanup\n    name = name:gsub(\"Copie de schéma \", \"\")\n    name = name:gsub(\"de soutien de construct\", \"\")\n    name = name:gsub(\"d'unités centrales\", \"\")\n    name = name:gsub(\"(de palier)\", \"\")\n    name = name:gsub(\"\" .. tempTier, \"\")\n\n    schematics[#schematics + 1] = { id = id, name = name, max = max, tier = tempTier, priority = priority, sn = ScreenNumber }\nend\n\nfunction formatScript(data, horizontal, inverted)\n    return [[---\n--- Created by Zrips#9691.\n--- DateTime: 2022-10-05 15:12\n--- Updated by Vtreka#1337\n--- DateTime: 2023-02-26 00:48\n\nfont = loadFont('Play', 25)\nsmallFont = loadFont('Play', 15)\nmidFont = loadFont('Play', 20)\ntinyFont = loadFont('Play', 10)\n\nif not init then\n    init = true\n\n    lastUpdate = getTime()\n\n    mfloor = math.floor\n    mceil = math.ceil\n\n    lowPriorityColor = { r = 128 / 255, g = 128 / 255, b = 128 / 255 } --export: Low Priority Colour\n    cyanColor = { r = 135 / 255, g = 206 / 255, b = 235 / 255 }\n    uiSettings = { r = 37 / 255, g = 57 / 255, b = 64 / 255 }\n    tier1Color = { r = 255 / 255, g = 255 / 255, b = 255 / 255 } --export: Tier 1 Colour\n    tier2Color = { r = 0 / 255, g = 255 / 255, b = 0 / 255 } --export: Tier 2 Colour\n    tier3Color = { r = 0 / 255, g = 127 / 255, b = 255 / 255 } --export: Tier 3 Colour\n    tier4Color = { r = 255 / 255, g = 0 / 255, b = 255 / 255 } --export: Tier 4 Colour\n    tier5Color = { r = 255 / 255, g = 102 / 255, b = 0 / 255 } --export: Tier 5 Colour\n    highPriorityColor = { r = 255 / 255, g = 50 / 255, b = 0 / 255 } --export: High Priority Colour\n    backgroundColor = { r = 13 / 255, g = 24 / 255, b = 28 / 255 }\n    redColor = { r = 254 / 255, g = 69 / 255, b = 0 / 255 }\n\n    barColorGood = { r = 4 / 255, g = 159 / 255, b = 0 / 255 }\n    barColorBad = { r = 177 / 255, g = 80 / 255, b = 0 / 255 }\n\n    realX, realY = getResolution()\n\n    barStartY = 40\n\n    barHeight = 21\n    barWidth = 130\n    barSpacing = 4\n\n    barInset = 2\n\n    sectionSpacing = 20\n\n    textBarSpacing = 10\n\n    linkedToSchem = ]] .. tostring(linkedToSchemContainer) .. [[\n    horizontal = ]] .. tostring(horizontal) .. [[\n    inverted = ]] .. tostring(inverted) .. [[\n    blocks = ]] .. data .. [[\n   \n    -- Inverting\n    if not horizontal then\n        ry, rx = realX, realY\n    else\n        rx, ry = realX, realY\n\n        barHeight = barHeight * 0.52\n        barWidth = barWidth * 0.6\n        barStartY = barStartY * 0.6\n    end\n\n    function round(number, decimals)\n        local power = 10 ^ decimals\n        return mfloor(number * power) / power\n    end\n\n    function mixColors(color1, color2, percent)\n        local inverse_percent = 1 - percent\n        local redPart = color2.r * percent + color1.r * inverse_percent\n        local greenPart = color2.g * percent + color1.g * inverse_percent\n        local bluePart = color2.b * percent + color1.b * inverse_percent\n        return { r = redPart, g = greenPart, b = bluePart };\n    end\n\n    function round(number, decimals)\n        local power = 10 ^ decimals\n        return mceil(number * power) / power\n    end\nend\n\nlocal layer = createLayer()\nif not horizontal then\n    setLayerOrigin(layer, realX / 2, realY / 2)\n\n    if inverted then\n        setLayerTranslation(layer, (realY - realX) / 2, -realY / 3)\n        setLayerRotation(layer, -1.5708)\n    else\n        setLayerTranslation(layer, (realX - realY) / 2, realY / 3)\n        setLayerRotation(layer, 1.5708)\n    end\n\n    font = loadFont('Play', 25)\n    smallFont = loadFont('Play', 15)\n    midFont = loadFont('Play', 20)\n    tinyFont = loadFont('Play', 10)\n\nelse\n    if inverted then\n        setLayerOrigin(layer, realX / 2, realY / 2)\n        setLayerRotation(layer, 3.14159)\n    end\n    font = loadFont('Play', 20)\n    smallFont = loadFont('Play', 12)\n    midFont = loadFont('Play', 12)\n    tinyFont = loadFont('Play', 10)\nend\n\nsetBackgroundColor(backgroundColor.r, backgroundColor.g, backgroundColor.b)\n\nlocal pos = 0\nlocal localPos = 1\n\nlocal blockWidth = rx\nif horizontal then\n    blockWidth = blockWidth / #blocks\nend\n\nfunction getColor(material, progress)\n    if material.p then\n        if progress < 100 and material.max > 0 then\n            return highPriorityColor\n        end\n        return tier1Color\n    elseif material.p == nil and progress < 100 and material.max > 0 then\n        return tier1Color\n    end\n    return lowPriorityColor\nend\n\nfunction drawLine(material, x, y)\n\n    local alpha = 0.8\n    if localPos % 2 == 0 then\n        alpha = 0.1\n    end\n\n    local rx = x + blockWidth\n\n    setNextFillColor(layer, uiSettings.r, uiSettings.g, uiSettings.b, alpha)\n    setNextStrokeColor(layer, 0, 0, 0, 0)\n    setNextStrokeWidth(layer, 0)\n    addBox(layer, x + textBarSpacing * 2, y, blockWidth - (textBarSpacing * 4), barHeight)\n\n    local progress = 0\n    if material.max > 0 then\n        progress = mfloor(material.volume * 100 / material.max)\n    end\n\n    if progress > 100 then\n        progress = 100\n    end\n\n    local width = progress * barWidth / 100\n\n    setNextTextAlign(layer, AlignH_Left, AlignV_Middle)\n    local textX = x + (textBarSpacing * 2)\n    local barX = rx - (textBarSpacing * 2) - barWidth\n    local secBarX = barX + 2\n    local volumeX = barX - textBarSpacing\n    local percentX = barX + (barWidth / 2)\n\n    alpha = 1\n\n    -- Material name section\n\n    local priorityColor = getColor(material, progress)\n    setNextFillColor(layer, priorityColor.r, priorityColor.g, priorityColor.b, 0.5)\n\n    if material.p and progress < 100 and material.max > 0 then\n        setNextFillColor(layer, priorityColor.r, priorityColor.g, priorityColor.b, 0.5)\n    elseif material.tier == 2 or material.tier == 11 then\n        setNextFillColor(layer, tier2Color.r, tier2Color.g, tier2Color.b, 0.5)\n    elseif material.tier == 3 or material.tier == 12 then\n        setNextFillColor(layer, tier3Color.r, tier3Color.g, tier3Color.b, 0.5)    \n    elseif material.tier == 4 or material.tier == 13 then\n        setNextFillColor(layer, tier4Color.r, tier4Color.g, tier4Color.b, 0.5)\n    elseif material.tier == 5 then\n        setNextFillColor(layer, tier5Color.r, tier5Color.g, tier5Color.b, 0.5)\n    end\n\n    addText(layer, midFont, material.name, textX, y + (barHeight / 2))\n\n    -- Bar background section\n    setNextFillColor(layer, uiSettings.r, uiSettings.g, uiSettings.b, alpha)\n\n    if horizontal then\n        setNextStrokeColor(layer, cyanColor.r, cyanColor.g, cyanColor.b, 0.5)\n    else\n        setNextStrokeColor(layer, cyanColor.r, cyanColor.g, cyanColor.b, alpha)\n    end\n    setNextStrokeWidth(layer, 0.1)\n    addBox(layer, barX, y, barWidth, barHeight)\n\n    if progress > 0 then\n        -- Dynamic bar section\n        local fillColor = mixColors(barColorBad, barColorGood, progress / 100)\n        setNextFillColor(layer, fillColor.r, fillColor.g, fillColor.b, 1)\n        setNextStrokeColor(layer, 0, 0, 0, 0)\n        addBox(layer, secBarX, y + barInset, width - (barInset * 2), barHeight - (barInset * 2))\n    end\n\n    -- Percentage section\n    setNextTextAlign(layer, AlignH_Center, AlignV_Middle)\n    setNextStrokeColor(layer, 0.1, 0.1, 0.1, 0.8)\n    if horizontal then\n        setNextStrokeWidth(layer, 0.8)\n    else\n        setNextStrokeWidth(layer, alpha)\n    end\n    setNextFillColor(layer, priorityColor.r, priorityColor.g, priorityColor.b, 1)\n    addText(layer, smallFont, progress .. \"%\", percentX, y + (barHeight / 2))\n\n    -- Volume section\n    setNextFillColor(layer, priorityColor.r, priorityColor.g, priorityColor.b, 0.5)\n\n    setNextTextAlign(layer, AlignH_Right, AlignV_Middle)\n    setNextStrokeColor(layer, 0.1, 0.1, 0.1, 0.8)\n    setNextStrokeWidth(layer, 0.5)\n    addText(layer, smallFont, mfloor(material.volume) .. \" / \" .. mfloor(material.max), volumeX, y + (barHeight / 2))\nend\n\nlocal offset = 0\nlocal prevTier = 0\nlocal sectionStartY = 0\n\nfunction drawBorder(x)\n\n    setNextFillColor(layer, 0, 0, 0, 0)\n    if linkedToSchem then\n        setNextStrokeColor(layer, cyanColor.r, cyanColor.g, cyanColor.b, 0.5)\n    else\n        setNextStrokeColor(layer, redColor.r, redColor.g, redColor.b, 0.5)\n    end\n    setNextStrokeWidth(layer, 0.01)\n    addBox(layer, x + (barSpacing * 4), sectionStartY - barHeight, blockWidth - (barSpacing * 8), barStartY + (pos * (barHeight + barSpacing)) + offset - sectionStartY - (barSpacing * 2))\nend\n\nfunction processBlock(bn, block)\n\n    local lx = (bn - 1) * blockWidth\n\n    for id, schematic in ipairs(block) do\n\n        if prevTier ~= schematic.tier then\n            offset = offset + (barSpacing * 1.8) + barHeight\n            prevTier = schematic.tier\n            localPos = 1\n\n            if sectionStartY > 0 then\n                drawBorder((bn - 1) * blockWidth)\n            end\n\n        sectionStartY = barStartY + (pos * (barHeight + barSpacing)) + offset\n\n        local tierName = \"Tier \" .. schematic.tier\n\n        if schematic.tier == 1 then\n            setNextTextAlign(layer, AlignH_Center, AlignV_Middle)\n            setNextFillColor(layer, tier1Color.r, tier1Color.g, tier1Color.b, 1)\n            addText(layer, midFont, tierName, lx + (blockWidth / 2), barStartY + (pos * (barHeight + barSpacing)) + offset - (barHeight / 2))    \n        elseif schematic.tier == 2 then\n            setNextTextAlign(layer, AlignH_Center, AlignV_Middle)\n            setNextFillColor(layer, tier2Color.r, tier2Color.g, tier2Color.b, 0.5)\n            addText(layer, midFont, tierName, lx + (blockWidth / 2), barStartY + (pos * (barHeight + barSpacing)) + offset - (barHeight / 2))\n        elseif schematic.tier == 3 then\n            setNextTextAlign(layer, AlignH_Center, AlignV_Middle)\n            setNextFillColor(layer, tier3Color.r, tier3Color.g, tier3Color.b, 1)\n            addText(layer, midFont, tierName, lx + (blockWidth / 2), barStartY + (pos * (barHeight + barSpacing)) + offset - (barHeight / 2))\n        elseif schematic.tier == 4 then\n            setNextTextAlign(layer, AlignH_Center, AlignV_Middle)\n            setNextFillColor(layer, tier4Color.r, tier4Color.g, tier4Color.b, 0.5)\n            addText(layer, midFont, tierName, lx + (blockWidth / 2), barStartY + (pos * (barHeight + barSpacing)) + offset - (barHeight / 2))\n        elseif schematic.tier == 5 then\n            setNextTextAlign(layer, AlignH_Center, AlignV_Middle)\n            setNextFillColor(layer, tier5Color.r, tier5Color.g, tier5Color.b, 1)\n            addText(layer, midFont, tierName, lx + (blockWidth / 2), barStartY + (pos * (barHeight + barSpacing)) + offset - (barHeight / 2))\n        elseif schematic.tier == 6 then\n            tierName = \"Construct Support\"\n            setNextTextAlign(layer, AlignH_Center, AlignV_Middle)\n            setNextFillColor(layer, tier1Color.r, tier1Color.g, tier1Color.b, 1)\n            addText(layer, midFont, tierName, lx + (blockWidth / 2), barStartY + (pos * (barHeight + barSpacing)) + offset - (barHeight / 2))\n        elseif schematic.tier == 7 then\n            tierName = \"Core Unit\"\n            setNextTextAlign(layer, AlignH_Center, AlignV_Middle)\n            setNextFillColor(layer, tier1Color.r, tier1Color.g, tier1Color.b, 1)\n            addText(layer, midFont, tierName, lx + (blockWidth / 2), barStartY + (pos * (barHeight + barSpacing)) + offset - (barHeight / 2))\n        elseif schematic.tier == 8 then\n            tierName = \"Deployables\"\n            setNextTextAlign(layer, AlignH_Center, AlignV_Middle)\n            setNextFillColor(layer, tier1Color.r, tier1Color.g, tier1Color.b, 1)\n            addText(layer, midFont, tierName, lx + (blockWidth / 2), barStartY + (pos * (barHeight + barSpacing)) + offset - (barHeight / 2))\n        elseif schematic.tier == 9 then\n            tierName = \"Fuel\"\n            setNextTextAlign(layer, AlignH_Center, AlignV_Middle)\n            setNextFillColor(layer, tier1Color.r, tier1Color.g, tier1Color.b, 1)\n            addText(layer, midFont, tierName, lx + (blockWidth / 2), barStartY + (pos * (barHeight + barSpacing)) + offset - (barHeight / 2))\n        elseif schematic.tier == 10 then\n            tierName = \"Scrap\"\n            setNextTextAlign(layer, AlignH_Center, AlignV_Middle)\n            setNextFillColor(layer, tier1Color.r, tier1Color.g, tier1Color.b, 1)\n            addText(layer, midFont, tierName, lx + (blockWidth / 2), barStartY + (pos * (barHeight + barSpacing)) + offset - (barHeight / 2))\n        elseif schematic.tier == 11 then\n            tierName = \"Tier 2 Ammo\"\n            setNextTextAlign(layer, AlignH_Center, AlignV_Middle)\n            setNextFillColor(layer, tier2Color.r, tier2Color.g, tier2Color.b, 0.5)\n            addText(layer, midFont, tierName, lx + (blockWidth / 2), barStartY + (pos * (barHeight + barSpacing)) + offset - (barHeight / 2))\n        elseif schematic.tier == 12 then\n            tierName = \"Tier 3 Ammo\"\n            setNextTextAlign(layer, AlignH_Center, AlignV_Middle)\n            setNextFillColor(layer, tier3Color.r, tier3Color.g, tier3Color.b, 1)\n            addText(layer, midFont, tierName, lx + (blockWidth / 2), barStartY + (pos * (barHeight + barSpacing)) + offset - (barHeight / 2))\n        elseif schematic.tier == 13 then\n            tierName = \"Tier 4 Ammo\"\n            setNextTextAlign(layer, AlignH_Center, AlignV_Middle)\n            setNextFillColor(layer, tier4Color.r, tier4Color.g, tier4Color.b, 0.5)\n            addText(layer, midFont, tierName, lx + (blockWidth / 2), barStartY + (pos * (barHeight + barSpacing)) + offset - (barHeight / 2))\n        end\n    end\n\n        drawLine(schematic, (bn - 1) * blockWidth, barStartY + (pos * (barHeight + barSpacing)) + offset)\n        pos = pos + 1\n        localPos = localPos + 1\n    end\nend\n\nif horizontal then\n    for ids, block in ipairs(blocks) do\n        offset = 0\n        prevTier = 0\n        sectionStartY = 0\n\n        pos = 0\n        localPos = 1\n        processBlock(ids, block)\n        offset = offset + (barSpacing * 1.8) + barHeight\n        drawBorder((ids - 1) * blockWidth)\n    end\nelse\n    processBlock(1, blocks)\n    offset = offset + (barSpacing * 1.8) + barHeight\n    drawBorder(0)\nend\n\nsetNextFillColor(layer, tier1Color.r, tier1Color.g, tier1Color.b, 0)\nsetNextStrokeColor(layer, cyanColor.r, cyanColor.g, cyanColor.b, 1)\nsetNextStrokeWidth(layer, 0.1)\naddBox(layer, 10, 10, rx - 20, ry - 20)\n\nif lastUpdate + 30 > getTime() then\n    setNextFillColor(layer, 1, 1, 1, 0.5)\n    setNextTextAlign(layer, AlignH_Center, AlignV_Middle)\n    if horizontal then\n        addText(layer, midFont, mfloor(30 - (getTime() - lastUpdate)) .. \"s\", 30, 20)\n    else\n        addText(layer, midFont, mfloor(30 - (getTime() - lastUpdate)) .. \"s\", 35, 30)\n    end\nend\n\nlocal textY = 40\n\nif horizontal then\n    textY = 27\nend\n\nif linkedToSchem then\n    setNextFillColor(layer, 1, 1, 1, 0.5)\nelse\n    setNextFillColor(layer, redColor.r, redColor.g, redColor.b, 0.7)\nend\nsetNextTextAlign(layer, AlignH_Right, AlignV_Baseline)\naddText(layer, font, \"Schematics Bank\", rx / 2 + 50, textY)\n\nsetNextFillColor(layer, 1, 1, 1, 0.5)\nsetNextTextAlign(layer, AlignH_Left, AlignV_Baseline)\naddText(layer, tinyFont, \"v2.1\", rx / 2 + 55, textY)\n\nfunction priority(x, y, text, color, alpha)\n\n    local boxSize = 10\n\n    setNextFillColor(layer, color.r, color.g, color.b, alpha)\n    setNextTextAlign(layer, AlignH_Right, AlignV_Middle)\n    addText(layer, smallFont, text, x - boxSize - 5, y)\n\n    setNextFillColor(layer, color.r, color.g, color.b, alpha)\n    setNextStrokeColor(layer, 0, 0, 0, 0)\n    addBox(layer, x - boxSize, y - (boxSize / 2), boxSize, boxSize)\nend\n\nfunction addPriorityInfo()\n\n    if horizontal then\n        setNextFillColor(layer, cyanColor.r, cyanColor.g, cyanColor.b, 1)\n        setNextTextAlign(layer, AlignH_Center, AlignV_Middle)\n        addText(layer, smallFont, \"Priority\", rx - 190, 20)\n\n        priority(rx - 20, 20, \"Low\", lowPriorityColor, 1)\n        priority(rx - 65, 20, \"Normal\", tier1Color, 1)\n        priority(rx - 125, 20, \"High\", highPriorityColor, 0.5)\n    else\n        setNextFillColor(layer, cyanColor.r, cyanColor.g, cyanColor.b, 1)\n        setNextTextAlign(layer, AlignH_Center, AlignV_Middle)\n        addText(layer, smallFont, \"Priority\", rx - 100, 20)\n\n        priority(rx - 20, 35, \"Low\", lowPriorityColor, 1)\n        priority(rx - 70, 35, \"Normal\", tier1Color, 1)\n        priority(rx - 140, 35, \"High\", highPriorityColor, 0.5)\n    end\nend\naddPriorityInfo()\n\nrequestAnimationFrame(30)]]\n\nend\n\nfunction schematicsTracker()\n\n    -- Keep ID as it is which if first number\n    -- Second number defines amount you want to have\n    -- Third value is optional, set it to true if you want it to be prioritized, set it to false for low priority\n    -- keeping last value empty will make schematic normal priority\n\n    setTier(1)\n    -- Tier 1 Product Material\n    addSchematic(690638651, 6000, true)\n    -- Tier 1 XS Element\n    addSchematic(1910482623, 50)\n    -- Tier 1 S Element\n    addSchematic(4148773283, 50)\n    -- Tier 1 M Element\n    addSchematic(2066101218, 50)\n    -- Tier 1 L Element\n    addSchematic(2068774589, 100)\n    -- Tier 1 XL Element\n    addSchematic(304578197, 50)\n    -- Tier 1 Honeycomb\n    addSchematic(2479827059, 500)\n\n    setTier(2)\n    -- Tier 2 Product Material\n    addSchematic(4073976374, 4000, true)\n    -- Tier 2 Pure Material\n    addSchematic(3332597852, 4000, true)\n    -- Tier 2 XS Element\n    addSchematic(2096799848, 40)\n    -- Tier 2 S Element\n    addSchematic(1752968727, 40)\n    -- Tier 2 M Element\n    addSchematic(2726927301, 40)\n    -- Tier 2 L Element\n    addSchematic(616601802, 60)\n    -- Tier 2 XL Element\n    addSchematic(3677281424, 40)\n    -- Tier 2 Honeycomb\n    addSchematic(632722426, 500)\n    -- Tier 2 Honeycomb\n    addSchematic(625377458, 500)\n\n    setTier(3)\n    -- Tier 3 Product Material\n    addSchematic(3707339625, 1000, true)\n    -- Tier 3 Pure Material\n    addSchematic(2003602752, 1000, true)\n    -- Tier 3 XS Element\n    addSchematic(787727253, 30)\n    -- Tier 3 S Element\n    addSchematic(425872842, 30)\n    -- Tier 3 M Element\n    addSchematic(3713463144, 30)\n    -- Tier 3 L Element\n    addSchematic(1427639881, 30)\n    -- Tier 3 XL Element\n    addSchematic(109515712, 30)\n    -- Tier 3 Honeycomb\n    addSchematic(2343247971, 500)\n    -- Tier 3 Honeycomb\n    addSchematic(4221430495, 500)\n\n    setTier(4)\n    -- Tier 4 Product Material\n    addSchematic(2485530515, 500, true)\n    -- Tier 4 Pure Material\n    addSchematic(2326433413, 500, true)\n    -- Tier 4 XS Element\n    addSchematic(210052275, 30)\n    -- Tier 4 S Element\n    addSchematic(3890840920, 30)\n    -- Tier 4 M Element\n    addSchematic(3881438643, 30)\n    -- Tier 4 L Element\n    addSchematic(1614573474, 30)\n    -- Tier 4 XL Element\n    addSchematic(1974208697, 30)\n    -- Tier 4 Honeycomb\n    addSchematic(3743434922, 500)\n    -- Tier 4 Honeycomb\n    addSchematic(99491659, 500)\n\n    moveToNextScreen()\n    setTier(5)\n\n    -- Tier 5 Product Material\n    addSchematic(2752973532, 500)\n    -- Tier 5 Pure Material\n    addSchematic(1681671893, 500, true)\n    -- Tier 5 XS Element\n    addSchematic(1513927457, 30)\n    -- Tier 5 S Element\n    addSchematic(880043901, 30)\n    -- Tier 5 M Element\n    addSchematic(3672319913, 30)\n    -- Tier 5 L Element\n    addSchematic(86717297, 30)\n    -- Tier 5 XL Element\n    addSchematic(1320378000, 30)\n    -- Tier 5 Honeycomb\n    addSchematic(1885016266, 500)\n    -- Tier 5 Honeycomb\n    addSchematic(3303272691, 500)\n\n    setTier(6)\n    -- Construct Support XS\n    addSchematic(1477134528, 100, true)\n    -- Construct Support S\n    addSchematic(1224468838, 100, true)\n    -- Construct Support M\n    addSchematic(1861676811, 200, true)\n    -- Construct Support L\n    addSchematic(784932973, 200, true)\n    \n    setTier(7)\n    -- Core Unit xs\n    addSchematic(120427296, 10)\n    -- Core Unit s\n    addSchematic(1213081642, 10)\n    -- Core Unit M\n    addSchematic(1417495315, 20)\n    -- Core Unit L\n    addSchematic(1202149588, 20)\n\n    setTier(8)\n    -- Bonsai\n    addSchematic(674258992, 1, false)\n    -- Territory Unit\n    addSchematic(318308564, 7)\n    -- Warp Beacon\n    addSchematic(3437488324, 1, false)\n\n    setTier(9)\n    -- Atmo Fuel\n    addSchematic(3077761447, 5000, true)\n    -- Rocket Fuel\n    addSchematic(3992802706, 2000, false)\n    -- Space Fuel\n    addSchematic(1917988879, 5000, true)\n    -- Warp cells\n    addSchematic(363077945, 5000)\n    \n    setTier(10)\n    -- Tier 2 Scrap\n    addSchematic(1952035274, 1000)\n    -- Tier 3 Scrap\n    addSchematic(2566982373, 1000)\n    -- Tier 4 Scrap\n    addSchematic(1045229911, 1000, true)\n    -- Tier 5 Scrap\n    addSchematic(2702634486, 1000, true)\n\n    moveToNextScreen()\n    setTier(11)\n    -- Tier 2 XS Ammo\n    addSchematic(326757369, 1000, false)\n    -- Tier 2 S Ammo\n    addSchematic(3336558558, 1000, false)\n    -- Tier 2 M Ammo\n    addSchematic(399761377, 1000, false)\n    -- Tier 2 L Ammo\n    addSchematic(512435856, 1000, false)\n        \n    setTier(12)\n    -- Tier 3 XS Ammo\n    addSchematic(2413250793, 1000, false)\n    -- Tier 3 S Ammo\n    addSchematic(1705420479, 1000, false)\n    -- Tier 3 M Ammo\n    addSchematic(3125069948, 1000, false)\n    -- Tier 3 L Ammo\n    addSchematic(2913149958, 1000, false)\n    \n    setTier(13)   \n    -- Tier 4 XS Ammo\n    addSchematic(2293088862, 1000, false)\n    -- Tier 4 S Ammo\n    addSchematic(3636126848, 1000, false)\n    -- Tier 4 M Ammo\n    addSchematic(3847207511, 1000, false)\n    -- Tier 4 L Ammo\n    addSchematic(2557110259, 1000, false)\nend\n\nschematicsTracker()\n\nif not checkSchematicsContainer then\n    linkedToSchemContainer = true\nend\n\nunit.hideWidget()\n\nfunction updateScreens()\n    local serialized = {}\n    for id, info in ipairs(information) do\n        serialized[id] = serialize(info)\n    end\n\n    for id, screenObject in ipairs(screens) do\n\n        local horizontal = false\n        local inverted = false\n        local script = serialized[screenObject.sn]\n\n        if screenObject.dir == \"hu\" or screenObject.dir == \"hd\" then\n            horizontal = true\n            if screenObject.dir == \"hd\" then\n                inverted = true\n            end\n            script = serialize(information)\n        elseif  screenObject.dir == \"vr\" then\n            inverted = true\n        end\n\n        screenObject.screen.setRenderScript(formatScript(script, horizontal, inverted))\n    end\nend\n\nfunction generateItemUpdate()\n    local map = container.getContent()\n    tempInfo = {}\n    for _, i in ipairs(map) do\n        local schem = getExistingSchematic(i.id)\n        if schem ~= nil then\n            local item = system.getItem(i.id)\n            local existingId, existingItem = getExisting(item.id)\n            if existingItem == nil then\n                tempInfo[#tempInfo + 1] = { id = item.id, name = item.displayName:gsub(\"Schematic Copy\", \"\"), volume = mfloor(i.quantity), max = schem.max, tier = item.tier, p = schem.priority }\n            else\n                existingItem.volume = mfloor(existingItem.volume + i.quantity)\n                tempInfo[existingId] = existingItem\n            end\n        end\n    end\n    return tempInfo\nend\n\nfunction getExisting(id)\n    for i, item in ipairs(tempInfo) do\n        if item.id == id then\n            return i, item\n        end\n    end\n    return -1, nil\nend\n\nfunction getExistingSchematic(id)\n    for i, item in ipairs(schematics) do\n        if item.id == id then\n            return item\n        end\n    end\n    return nil\nend\n\nfunction fillMissing()\n    \n    information = {}\n    for id, schematic in ipairs(schematics) do\n        local id, existing = getExisting(schematic.id)\n        local temp = information[schematic.sn] or {}\n        if not existing then\n            temp[#temp + 1] = { name = schematic.name, volume = 0, max = schematic.max, tier = schematic.tier, p = schematic.priority }\n        else\n            temp[#temp + 1] = { name = schematic.name, volume = existing.volume, max = schematic.max, tier = schematic.tier, p = schematic.priority }\n        end\n        information[schematic.sn] = temp\n    end\n    return information\nend\n\nfunction containerContentUpdate()\n    lastRequest = system.getArkTime()\n    requestingUpdateContent = false\n    generateItemUpdate()\n    fillMissing()\n    updateScreens()\nend\n\nlocal init = false\n\nfunction update()\n    requestingUpdateContent = true\n    container.updateContent()\n\n    if not init then\n        local map = container.getContent()\n        if map and #map > 0 then\n            generateItemUpdate()\n            fillMissing()\n            updateScreens()\n        end\n        init = true\n    end\nend\n\nupdate()\n\nunit.setTimer('update', 1)","filter":{"args":[],"signature":"onStart()","slotKey":"-1"},"key":"3"},{"code":"--- Dual Universe Schematics Monitor v2.1\n--- Created by Zrips.\n--- DateTime: 2022-10-06 11:03\n--- Updated by Vtreka#1337\n--- LastUpdate: 2023-03-11 06:37\n\nsystem.print(\" --- Schematics Bank v2.1 ---\")\n\nmceil = math.ceil\nsmatch = string.match\nssub = string.sub\n\nlocal concat = table.concat\nlocal function internalSerialize(table, tC, t)\n    t[tC] = \"{\"\n    tC = tC + 1\n    if #table == 0 then\n        local hasValue = false\n        for key, value in pairs(table) do\n            hasValue = true\n            local keyType = type(key)\n            if keyType == \"string\" then\n                t[tC] = key .. \"=\"\n            elseif keyType == \"number\" then\n                t[tC] = \"[\" .. key .. \"]=\"\n            elseif keyType == \"boolean\" then\n                t[tC] = \"[\" .. tostring(key) .. \"]=\"\n            else\n                t[tC] = \"notsupported=\"\n            end\n            tC = tC + 1\n\n            local check = type(value)\n            if check == \"table\" then\n                tC = internalSerialize(value, tC, t)\n            elseif check == \"string\" then\n                t[tC] = '\"' .. value .. '\"'\n            elseif check == \"number\" then\n                t[tC] = value\n            elseif check == \"boolean\" then\n                t[tC] = tostring(value)\n            else\n                t[tC] = '\"Not Supported\"'\n            end\n            t[tC + 1] = \",\"\n            tC = tC + 2\n        end\n        if hasValue then\n            tC = tC - 1\n        end\n    else\n        for i = 1, #table do\n            local value = table[i]\n            local check = type(value)\n            if check == \"table\" then\n                tC = internalSerialize(value, tC, t)\n            elseif check == \"string\" then\n                t[tC] = '\"' .. value .. '\"'\n            elseif check == \"number\" then\n                t[tC] = value\n            elseif check == \"boolean\" then\n                t[tC] = tostring(value)\n            else\n                t[tC] = '\"Not Supported\"'\n            end\n            t[tC + 1] = \",\"\n            tC = tC + 2\n        end\n        tC = tC - 1\n    end\n    t[tC] = \"}\"\n    return tC\nend\n\nfunction serialize(value)\n    local t = {}\n    local check = type(value)\n\n    if check == \"table\" then\n        internalSerialize(value, 1, t)\n    elseif check == \"string\" then\n        return '\"' .. value .. '\"'\n    elseif check == \"number\" then\n        return value\n    elseif check == \"boolean\" then\n        return tostring(value)\n    else\n        return '\"Not Supported\"'\n    end\n\n    return concat(t)\nend\n\nfunction deserialize(s)\n    return load(\"return \" .. s)()\nend","filter":{"args":[],"signature":"onStart()","slotKey":"-5"},"key":"0"}],"methods":[],"events":[]}